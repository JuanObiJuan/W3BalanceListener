<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Charging App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <style>
    h3 {
      padding: 10px;
      background: rgba(51, 51, 51, 0.49);
      border-radius: 10px;
    }

    .full-screen {
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .carousel-indicators li {
      display: none;
    }

    .jumbotron {
      padding-top: 30px;
      padding-bottom: 30px;
      margin-bottom: 30px;
      margin-top: 30px;
      color: inherit;
      background-color: rgba(8, 8, 8, 0.44);
      border-radius: 10px;
    }

    .glyphicon-refresh-animate {
      -animation: spin .9s infinite linear;
      -webkit-animation: spin2 .9s infinite linear;
    }

    #outer {
      position: absolute;
      background-color: rgba(8, 8, 8, 0.8);
      left: 25%;
      right: 25%;
      bottom: 60%;
      top: 5%;
      z-index: 1;
      text-align: center;
    }

    @-webkit-keyframes spin2 {
      from {
        -webkit-transform: rotate(0deg);
      }
      to {
        -webkit-transform: rotate(360deg);
      }
    }

    @keyframes spin {
      from {
        transform: scale(1) rotate(0deg);
      }
      to {
        transform: scale(1) rotate(360deg);
      }
    }

    .glyphicon {
      position: relative;
      top: 12px;
      display: inline-block;
      font-family: 'Glyphicons Halflings';
      font-style: normal;
      font-weight: 400;
      line-height: 1;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      font: 13px Helvetica, Arial;
    }

    form {
      background: #000;
      padding: 3px;
      position: fixed;
      bottom: 0;
      width: 100%;
    }

    form input {
      border: 0;
      padding: 10px;
      width: 90%;
      margin-right: .5%;
    }

    form button {
      width: 9%;
      background: rgb(130, 224, 255);
      border: none;
      padding: 10px;
    }

    #messages {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }

    #messages li {
      padding: 5px 10px;
    }

    #messages li:nth-child(odd) {
      background: #eee;
    }
  </style>
</head>

<body>
  <!-- Header -->
  <div class="jumbotron" id="outer">
    <img src="/static/logo.png" style='height: 400%; width: 100%; object-fit: contain' alt="First Image">
    <span class="badge" id="account">Account 0x0</span>
    <span class="badge" id="balance">10.3</span>
  </div>
  <div id="mycarousel" class="carousel slide" data-ride="carousel">
    <!-- Indicators -->
    <ol class="carousel-indicators">
      <li data-target="#mycarousel" data-slide-to="0" class="active"></li>
      <li data-target="#mycarousel" data-slide-to="1"></li>
      <li data-target="#mycarousel" data-slide-to="2"></li>
      <li data-target="#mycarousel" data-slide-to="3"></li>
      <li data-target="#mycarousel" data-slide-to="4"></li>
    </ol>

    <!-- Wrapper for slides -->
    <div class="carousel-inner" role="listbox">
      <div class="item active">
        <img src="/static/syncing.jpeg" data-color="black" alt="First Image">
        <div class="carousel-caption">
          <div class="jumbotron">
            <h1 class="display-3"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> syncing</h1>
            <hr class="my-4">
            <p>Please wait until this client is in full sync</p>
          </div>

        </div>
      </div>
      <div class="item">
        <img src="/static/waiting.jpg" data-color="firebrick" alt="Second Image">
        <div class="carousel-caption">
          <div class="jumbotron">
            <h1 class="display-3">...waiting for transaction </h1>
            <hr class="my-4">
            <p>Please make a transfer to #account </p>
          </div>
        </div>
      </div>
      <div class="item">
        <img src="/static/cable.jpg" data-color="violet" alt="Third Image">
        <div class="carousel-caption">
          <div class="jumbotron">
            <h1 class="display-3">Ready?</h1>
            <span class="badge" id="amount">Charge for 10.3 Ethers</span>
            <hr class="my-4">
            <p>Connect your car and click here to start charging </p>
            <button type="button" id="okButton" class="btn btn-success btn-lg">Start Charging</button>
          </div>
        </div>
      </div>
      <div class="item">
        <img src="/static/charging.jpg" data-color="lightgreen" alt="Fourth Image">
        <div class="carousel-caption">
          <div class="jumbotron">
            <h1 class="display-3"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> charging</h1>
            <hr class="my-4">
            <p>Please wait until process has finished</p>
          </div>
        </div>
      </div>
      <div class="item">
        <img src="/static/earth.jpg" data-color="tomato" alt="Fifth Image">
        <div class="carousel-caption">
          <div class="jumbotron">
            <h1 class="display-3">Thank You!!</h1>
            <hr class="my-4">
            <p>You can now disconnect the cable</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    var $item = $('.carousel .item');
    var $wHeight = $(window).height();
    $item.eq(0).addClass('active');
    $item.height($wHeight);
    $item.addClass('full-screen');

    $('.carousel img').each(function() {
      var $src = $(this).attr('src');

      $(this).parent().css({
        'background-image': 'url(' + $src + ')',

      });
      $(this).remove();
    });

    $(window).on('resize', function() {
      $wHeight = $(window).height();
      $item.height($wHeight);
    });

    $('.carousel').carousel({
      interval: 0,
      pause: "true"
    })

    $('.carousel').carousel(0);
  </script>
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script>
    $(function() {
      var socket = io();

      socket.on('set account', function(account) {
        $('#account')[0].innerHTML = "Account " + account;
      });
      socket.on('set balance', function(balance) {
        $('#balance')[0].innerHTML = balance;
      });
      socket.on('set amount', function(amount) {
        $('#amount')[0].innerHTML = "Charge for " + amount + " Ethers";

      });
      socket.on('set status', function(msg) {
        $('#mycarousel').carousel(parseInt(msg));
        if (msg==1) {
          console.log('new status client '+msg);
            var audio = new Audio('/static/insync.mp3');
            audio.play();
        }
        if (msg==2) {
          var audio = new Audio('/static/transaction.mp3');
          audio.play();
        }
        if (msg==3) {
          var audio = new Audio('/static/charge.mp3');
          audio.play();
        }
        if (msg==4) {
          var audio = new Audio('/static/end.mp3');
          audio.play();
        }
      });

      $('#okButton').click(function() {
        socket.emit('startCharging', 'startCharging');
      });




    });
  </script>

</body>

</html>
